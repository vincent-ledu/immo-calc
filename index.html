<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="index.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
  </head>

  <body>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <div class="container">
      <div id="app">
        <div id="acquisition" name="acquisition">
          <p class="row">
            <label class="col-sm">Prix net vendeur :</label>
            <input
              class="col-sm eur-input"
              id="net_seller_price"
              name="net_seller_price"
              v-model="net_seller_price"
            />
          </p>
          <p class="row">
            <label class="col-sm">Frais d'agence :</label>
            <input
              class="col-sm"
              id="agency_fees"
              name="agency_fees"
              v-model="agency_fees"
            />
          </p>
          <p class="row">
            <label class="col-sm">Type de bien :</label>
            <select
              id="asset_type"
              name="asset_type"
              v-model="asset_type"
              class="col-sm"
            >
              <option value="0">Ancien ou terrain</option>
              <option value="1">Neuf</option>
            </select>
          </p>
        </div>
        <div id="notary" name="notary">
          <p class="row">
            <label class="col-sm">Pourcentage des frais de notaire :</label>
            <input
              id="notary_fees_percent"
              name="notary_fees_percent"
              disabled
              readonly
              v-model="notary_fees_percent"
              class="col-sm"
            />
          </p>
          <p class="row">
            <label class="col-sm">Frais de notaire</label>
            <input
              id="notary_fees"
              name="notary_fees"
              disabled
              readonly
              v-model="notary_fees"
              class="col-sm"
            />
          </p>
        </div>
        <div id="income_expense">
          <p class="row">
            <label class="col-sm">Revenu net mensuel: </label>
            <input id="income" name="income" v-model="income" class="col-sm" />
          </p>
          <p class="row">
            <label class="col-sm"
              >Autre charge (autres crédits, pensions, ...):
            </label>
            <input
              id="other_expense"
              name="other_expense"
              v-model="other_expense"
              class="col-sm"
            />
          </p>
          <p class="row">
            <label class="col-sm"
              >Apport personnel (hors vente d'autres biens) :</label
            >
            <input
              id="personnal_money"
              name="personnal_money"
              v-model="personnal_money"
              class="col-sm"
            />
          </p>
        </div>
        <div id="relay" name="relay">
          <p class="row">
            <label class="col-sm">Besoin d'un prêt relais ? </label>
            <select
              id="relay_loan"
              name="relay_loan"
              v-model="relay_loan"
              class="col-sm"
            >
              <option value="0">Non</option>
              <option value="1">Oui</option>
            </select>
          </p>
          <div v-if="relay_loan == 1">
            <p class="row">
              <label class="col-sm">Prix de vente résidence(s) :</label>
              <input
                id="asset_sell_price"
                name="asset_sell_price"
                v-model="asset_sell_price"
                class="col-sm"
              />
            </p>
            <p class="row">
              <label class="col-sm">Montant du prêt relais :</label>
              <input
                id="relay_loan_amount"
                name="relay_loan_amount"
                disabled
                readonly
                v-model="relay_loan_amount"
                class="col-sm"
              />
            </p>
            <p class="row">
              <label class="col-sm">Durée (mois) :</label>
              <input
                id="relay_loan_duration"
                name="relay_loan_duration"
                v-model="relay_loan_duration"
                class="col-sm"
              />
            </p>
            <p class="row">
              <label class="col-sm">Taux : </label>
              <input
                id="relay_loan_tx"
                name="relay_loan_tx"
                v-model="relay_loan_tx"
                class="col-sm"
              />
            </p>
          </div>
        </div>
        <div id="main_loan" name="main_loan">
          <p class="row">
            <label class="col-sm">Montant du prêt principal :</label>
            <input
              id="main_loan_amount"
              name="main_loan_amount"
              v-model="main_loan_amount"
              class="col-sm"
            />
          </p>
          <p class="row">
            <label class="col-sm">Durée (mois) :</label>
            <input
              id="main_loan_duration"
              name="main_loan_duration"
              v-model="main_loan_duration"
              class="col-sm"
            />
          </p>
          <p class="row">
            <label class="col-sm">Taux : </label>
            <input
              id="main"
              name="main_loan_tx"
              v-model="main_loan_tx"
              class="col-sm"
            />
          </p>
        </div>
        <hr />
        <p>
          <label>Mensualité du prêt principal: {{ monthly_payment }}</label>
        </p>
        <p>
          <label
            >Mensualité du prêt relais (intérêt) : {{ relay_loan_monthly_payment
            }}</label
          >
        </p>
        <p>
          <label
            >Mensualité maximal (&lt; 33%) : {{ max_monthly_payment }}
          </label>
        </p>
        <p>
          <label>Taux d'endettement : {{ indebtment_rate }}</label>
        </p>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      const formatter = new Intl.NumberFormat("fr-FR", {
        style: "currency",
        currency: "EUR",
        minimumFractionDigits: 0,
      });

      $(document).ready(function() {
        $(".eur-input").blur(function() {
          let input = $(this);
          let value = $(".eur-input").val();
          input.val(formatter.format(value));
        });
      });
    </script>
  </body>
</html>
